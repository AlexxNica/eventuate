#!/bin/sh

EXAMPLE_MODE=normal
EXAMPLE_MAIN=com.rbmhtechnology.example.ordermgnt.OrderExample

while [[ $# > 1 ]]; do
    key="$1"
    case $key in
        -r|--recover)
        EXAMPLE_MODE=recover
        ;;
        -j|--java)
        EXAMPLE_MAIN=com.rbmhtechnology.example.ordermgnt.japi.OrderExample
        ;;
        *)
        # unknown option
        ;;
    esac
    shift # past argument or value
done

EXAMPLE_CONF=location-$1.conf

# try to generate the classpath script
# although it will be usually generated by './example' already
if [[ ! -f ./.example-classpath ]]; then
    sbt exampleClasspath || exit 1
fi

source ./.example-classpath

exec java -cp "$EXAMPLE_CLASSPATH" $EXAMPLE_MAIN $EXAMPLE_CONF $EXAMPLE_MODE
